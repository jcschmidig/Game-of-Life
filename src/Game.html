<section>
  <div class="container is-fluid">
    <nav class="level">
      <div class="level-left">
        <div class="level-item">
          <table class="table">
            <Measure title="Total" diff="{blank(_birth + _death)}" />
            <Measure title="Birth" diff="{blank(_birth)}" />
            <Measure title="Death" diff="{blank(_death)}" />
          </table>
        </div>
        <div class="level-item">
          <!-- prettier-ignore -->
          <Button
			  style=is-info
		      id="next"
			  width="12em"
		      name="{_showName}"
		      disabled="{!_nextEnabled}"
		      on:click
		    />
        </div>
        <div class="level-item">
          <table class="table">
            <Measure title="Total" diff="{blank(_alive + _dead)}" />
            <Measure title="Alive" diff="{blank(_alive)}" />
            <Measure title="Dead" diff="{blank(_dead)}" />
          </table>
        </div>
        <div class="level-item">
          <table class="table">
            <Measure title="Time" diff="{calc.unit}" />
            <Measure title="{calc.title}" diff="{_timeCalc}" />
            <Measure title="{showTitle}" diff="{showDiff}" />
          </table>
        </div>
      </div>
    </nav>
  </div>
</section>

<script>
  import { blank } from "./common/Util.html"
  import { fState } from "./Field.html"
  import Button from "./common/Button.html"
  import Measure from "./common/Measure.html"

  /*** Default Component Interface ***/
  export let status, calc, showTitle, showDiff

  /*** Observables ***/
  let _alive,
    _dead,
    _birth,
    _death,
    _timeCalc,
    _showgen = "-",
    _nextEnabled
  $: if (status) {
    _alive = status.countState(fState.alive)
    _dead = status.size - _alive
    _birth = status.countChangedState(fState.alive)
    _death = status.countChangedState(fState.dead)
    _timeCalc = calc.diff()
    _showgen = status.generation === "" ? "-" : status.generation
    _showName = "+ Generation (" + _showgen + ")"
    _nextEnabled = status.isReady || _birth || _death
  }
  $: _showName = "+ Generation (" + _showgen + ")"
</script>
