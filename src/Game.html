<section class="container">
  <div class="tile is-ancestor">
    <div class="tile is-parent">
      <div class="tile is-child is-2 box">
        <div class="tags">
          <Measure
            title="Alive"
            diff="{blank(_alive)}"
            style="is-success is-light"
          />
          <Measure
            title="Dead"
            diff="{blank(_dead)}"
            style="is-danger is-light"
          />
          <Measure
            title="Total"
            diff="{blank(_alive + _dead)}"
            style="is-info is-light"
          />
        </div>
      </div>
      <div class="tile is-3 is-child is-vertical box">
        <div class="tile is-child">
          <!-- prettier-ignore -->
          <Button
		style=is-primary
		id="next"
		width="auto"
		name="{_showName}"
		disabled="{!_nextEnabled}"
		on:click
	    />
        </div>
        <div class="tile is-child">
          <div class="tags">
            <Measure
              title="{calc.title}"
              diff="{blank(_timeCalc)+calc.unit}"
              style="is-light is-info"
            />
            <Measure
              title="{showTitle}"
              diff="{blank(showDiff)+calc.unit}"
              style="is-light is-info"
            />
          </div>
        </div>
      </div>
      <div class="tile is-child is-2 box is-hidden-mobile">
        <div class="tags">
          <Measure
            title="Birth"
            diff="{blank(_birth)}"
            style="is-light is-success"
          />
          <Measure
            title="Death"
            diff="{blank(_death)}"
            style="is-light is-danger"
          />
          <Measure
            title="Total"
            diff="{blank(_birth + _death)}"
            style="is-light is-info"
          />
        </div>
      </div>
    </div>
  </div>
</section>

<script>
  import { blank } from "./common/Util.html"
  import { fState } from "./Field.html"
  import Button from "./common/Button.html"
  import Measure from "./common/Measure.html"

  /*** Default Component Interface ***/
  export let status, calc, showTitle, showDiff

  /*** Observables ***/
  let _alive,
    _dead,
    _birth,
    _death,
    _timeCalc,
    _showgen = "-",
    _nextEnabled
  $: if (status) {
    _alive = status.countState(fState.alive)
    _dead = status.size - _alive
    _birth = status.countChangedState(fState.alive)
    _death = status.countChangedState(fState.dead)
    _timeCalc = calc.diff()
    _showgen = status.generation === "" ? "-" : status.generation
    _showName = "+ Generation (" + _showgen + ")"
    _nextEnabled = status.isReady || _birth || _death
  }
  $: _showName = "+ Generation (" + _showgen + ")"
</script>
